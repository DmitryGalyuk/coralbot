<!DOCTYPE html>
<html>

<head>
	<script nonce="undefined" src="https://cdn.zingchart.com/zingchart.min.js"></script>
	<script nonce="undefined" src="https://cdn.zingchart.com/modules-es6/zingchart-tree.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.3.0/exceljs.min.js"></script>
</head>

<body>

	Выбрать файл отчёта <input type="file" id="excelFile" />
	<button id="btnParse">Загрузить</button>
	<div id="myChart"></div>

	<script type="module">
		import parseReport from './js/parser.js'

		async function parseUploaded() {
			const file = document.querySelector('#excelFile').files[0];
			let [summary, data] = await parseReport(file);


			var chartData = {
				type: 'tree',
				options: {
					aspect: 'tree down',
					size: 'auto',
				},
				plot: {
					tooltip: {
						text: '%data-name',
					},
				},
				series: JSON.stringify( data)
			};
			zingchart.render({
				id: 'myChart',
				data: chartData,
				height: '100%',
				width: '100%'
			});
		}
		document.getElementById("btnParse").addEventListener('click', parseUploaded);
	</script>

</body>

</html>